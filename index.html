<!DOCTYPE html>
<html lang="pt-br" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mega Elite Analytics - Ataque Dinâmico v6.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>tailwind.config = { darkMode: 'class' }</script>
    <style>
        .quadrante-1 { background-color: #450a0a; color: #fecaca; } 
        .quadrante-2 { background-color: #3b0764; color: #e9d5ff; } 
        .quadrante-3 { background-color: #1e3a8a; color: #bfdbfe; } 
        .quadrante-4 { background-color: #451a03; color: #fde68a; }
        .numero-selecionado { background-color: #22c55e !important; color: #052e16 !important; transform: scale(1.1); z-index: 50; box-shadow: 0 0 15px #22c55e; }
        .cartao-estratega { background: linear-gradient(145deg, #1e293b, #0f172a); border: 2px solid #334155; transition: all 0.4s; border-radius: 2.5rem; }
        .cartao-estratega.usado { filter: grayscale(0.9) brightness(0.4); opacity: 0.6; transform: scale(0.95); }
        .grade-volante { display: grid; grid-template-columns: repeat(10, 1fr); gap: 2px; position: relative; padding: 12px; background: #020617; border-radius: 12px; }
        .linha-divisoria-horizontal { position: absolute; top: 50%; left: 0; right: 0; height: 2px; background-color: #22c55e; opacity: 0.3; z-index: 5; }
        .linha-divisoria-vertical { position: absolute; top: 0; bottom: 0; left: 50%; width: 2px; background-color: #22c55e; opacity: 0.3; z-index: 5; }
        .dezena-volante { aspect-ratio: 1; display: flex; align-items: center; justify-content: center; font-size: 0.65rem; font-weight: 700; color: #475569; border: 1px solid #1e293b; }
        .dezena-marcada { background-color: #22c55e !important; color: #052e16 !important; z-index: 10; border-radius: 2px; }
        .container-barra-status { background: #020617; height: 10px; border-radius: 99px; overflow: hidden; border: 1px solid #1e293b; }
        .preenchimento-ataque { background: linear-gradient(90deg, #ef4444, #f97316); height: 100%; transition: width 1.5s; }
        .preenchimento-defesa { background: linear-gradient(90deg, #3b82f6, #06b6d4); height: 100%; transition: width 1.5s; }
        .barra-frequencia-container { width: 100%; background-color: #0f172a; border-radius: 99px; height: 8px; margin-top: 6px; overflow: hidden; border: 1px solid #1e293b; }
        .barra-frequencia-progresso { height: 100%; background: linear-gradient(90deg, #064e3b 0%, #22c55e 100%); border-radius: 99px; transition: width 1.5s; }
        .bloco-estatistico { border-left: 4px solid #3b82f6; background: #161e2e; padding: 14px; margin-bottom: 12px; border-radius: 8px; border: 1px solid #1e293b; }
        .barra-rolagem-customizada::-webkit-scrollbar { width: 6px; }
        .barra-rolagem-customizada::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 10px; }
    </style>
</head>
<body class="bg-slate-950 text-slate-200 min-h-screen font-sans">

    <nav class="bg-slate-900 border-b border-green-900/30 p-6 sticky top-0 z-[100] backdrop-blur-md">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
            <div>
                <h1 class="text-2xl font-black italic text-green-500 uppercase">Mega<span class="text-white">Elite</span> v6.0</h1>
                <p class="text-[10px] text-green-700 font-bold uppercase tracking-widest">Ataque Dinâmico & Gestão de Registro</p>
            </div>
            <div class="flex gap-3">
                <button onclick="gerarCartasFechamento()" class="bg-green-600 px-8 py-2 rounded-full font-bold text-sm hover:bg-green-500 transition-all shadow-lg">FORJAR CARTAS</button>
                <button onclick="ativarSugestaoHistorica()" class="bg-blue-600 px-5 py-2 rounded-full font-bold text-xs">TOP 20 %</button>
                <button onclick="limparSistema()" class="text-slate-500 hover:text-white px-2 text-xs uppercase font-bold">Limpar</button>
            </div>
        </div>
    </nav>

    <main class="container mx-auto p-4 md:p-8">
        <div class="grid lg:grid-cols-12 gap-10">
            <div class="lg:col-span-5">
                <div class="bg-slate-900 p-8 rounded-[2rem] border border-slate-800 sticky top-28 shadow-2xl">
                    <h2 class="text-lg font-bold mb-6 flex items-center gap-2">Matriz de Seleção</h2>
                    <div id="volante-principal" class="grid grid-cols-10 gap-1.5 mb-8"></div>
                    <div id="painel-analytics" class="hidden animate-in fade-in duration-700">
                        <div id="lista-detalhada-estatisticas" class="max-h-[450px] overflow-y-auto pr-2 barra-rolagem-customizada space-y-4"></div>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-7">
                <div id="container-cartas-geradas" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="col-span-full py-32 text-center border-2 border-dashed border-slate-800 rounded-[3rem] opacity-30 italic">Gere cartas para análise de performance.</div>
                </div>
            </div>
        </div>
    </main>

    <script>
        let dezenasSelecionadas = new Set();
        const TOTAL_CONCURSOS = 2954;

        // Base com pesos de ataque diferenciados
        const bancoDeDadosElite = [
            { numero: 10, quadrante: 2, frequencia: 340, peso: 100 }, { numero: 53, quadrante: 3, frequencia: 332, peso: 98 },
            { numero: 05, quadrante: 1, frequencia: 319, peso: 95 }, { numero: 34, quadrante: 3, frequencia: 316, peso: 94 },
            { numero: 37, quadrante: 4, frequencia: 315, peso: 93 }, { numero: 33, quadrante: 3, frequencia: 312, peso: 92 },
            { numero: 38, quadrante: 4, frequencia: 312, peso: 92 }, { numero: 17, quadrante: 2, frequencia: 309, peso: 91 },
            { numero: 32, quadrante: 3, frequencia: 309, peso: 90 }, { numero: 43, quadrante: 4, frequencia: 308, peso: 89 },
            { numero: 56, quadrante: 4, frequencia: 307, peso: 88 }, { numero: 04, quadrante: 1, frequencia: 306, peso: 87 },
            { numero: 27, quadrante: 2, frequencia: 306, peso: 86 }, { numero: 30, quadrante: 2, frequencia: 306, peso: 85 },
            { numero: 42, quadrante: 3, frequencia: 306, peso: 84 }, { numero: 44, quadrante: 3, frequencia: 306, peso: 83 },
            { numero: 11, quadrante: 1, frequencia: 305, peso: 82 }, { numero: 35, quadrante: 3, frequencia: 305, peso: 81 },
            { numero: 46, quadrante: 4, frequencia: 305, peso: 80 }, { numero: 23, quadrante: 1, frequencia: 304, peso: 79 }
        ];

        function inicializarVolanteSelecao() {
            const v = document.getElementById('volante-principal');
            for (let i = 1; i <= 60; i++) {
                const b = document.createElement('button');
                b.innerText = i.toString().padStart(2, '0');
                b.id = `btn-sel-${i}`;
                const r = Math.floor((i-1)/10), c = (i-1)%10;
                const q = (r < 3 && c < 5) ? 1 : (r < 3 && c >= 5) ? 2 : (r >= 3 && c < 5) ? 3 : 4;
                b.className = `quadrante-${q} h-9 w-full rounded-lg font-bold text-[11px] transition-all border border-transparent hover:brightness-125`;
                b.onclick = () => {
                    if(dezenasSelecionadas.has(i)) { dezenasSelecionadas.delete(i); b.classList.remove('numero-selecionado'); }
                    else { dezenasSelecionadas.add(i); b.classList.add('numero-selecionado'); }
                };
                v.appendChild(b);
            }
        }

        function gerarCartasFechamento() {
            if (dezenasSelecionadas.size < 6) return alert("Selecione mais dezenas.");
            const container = document.getElementById('container-cartas-geradas');
            container.innerHTML = '';
            let cartas = 0;
            while(cartas < 8) {
                let jogo = Array.from(dezenasSelecionadas).sort(() => Math.random() - 0.5).slice(0, 6).sort((a,b) => a-b);
                const p = jogo.filter(n => n % 2 === 0).length;
                const quads = new Set(jogo.map(n => {
                    const r = Math.floor((n-1)/10), c = (n-1)%10;
                    return (r < 3 && c < 5) ? 1 : (r < 3 && c >= 5) ? 2 : (r >= 3 && c < 5) ? 3 : 4;
                })).size;
                if(quads >= 3 && p >= 2 && p <= 4) { renderCarta(jogo, cartas + 1, p, quads); cartas++; }
            }
        }

        function renderCarta(nums, id, pares, quads) {
            // ATAQUE HONESTO: Média real dos pesos de elite das dezenas escolhidas
            const somaPesos = nums.reduce((acc, n) => {
                const elite = bancoDeDadosElite.find(d => d.numero === n);
                return acc + (elite ? elite.peso : 35); // Se não for elite, peso base é baixo (35)
            }, 0);
            const atk = Math.round(somaPesos / 6);
            
            // DEFESA: Baseada na estrutura matemática (Quadrantes + Paridade)
            const def = (quads * 15) + (pares === 3 ? 40 : 25);
            
            const card = document.createElement('div');
            card.id = `card-${id}`;
            card.className = "cartao-estratega p-8 shadow-2xl";
            let grid = '<div class="grade-volante"><div class="linha-divisoria-horizontal"></div><div class="linha-divisoria-vertical"></div>';
            for(let i=1; i<=60; i++) grid += `<div class="dezena-volante ${nums.includes(i) ? 'dezena-marcada' : ''}">${i.toString().padStart(2, '0')}</div>`;
            grid += '</div>';

            card.innerHTML = `
                <div class="flex justify-between items-center mb-6">
                    <span class="text-xs font-black text-green-500 italic uppercase">ESTRATEGISTA #${id}</span>
                    <button onclick="document.getElementById('card-${id}').classList.toggle('usado')" class="bg-green-600 px-4 py-1.5 rounded-full text-[9px] font-bold text-white hover:bg-green-500">REGISTRAR</button>
                </div>
                ${grid}
                <div class="mt-8 space-y-4">
                    <div class="flex justify-between font-mono text-[11px] font-bold text-slate-300"><span>${nums.join(' · ')}</span><span>SOMA: ${nums.reduce((a,b)=>a+b,0)}</span></div>
                    <div><div class="flex justify-between text-[10px] font-black mb-1"><span>ATAQUE (DENSIDADE)</span><span>${atk}%</span></div><div class="container-barra-status"><div class="preenchimento-ataque" style="width:${atk}%"></div></div></div>
                    <div><div class="flex justify-between text-[10px] font-black mb-1"><span>DEFESA (EQUILÍBRIO)</span><span>${def}%</span></div><div class="container-barra-status"><div class="preenchimento-defesa" style="width:${def}%"></div></div></div>
                    <p class="text-[10px] text-slate-500 italic mt-4 leading-relaxed"><b>Racional:</b> Ataque de ${atk}% calculado pela força histórica individual das dezenas. Defesa de ${def}% garantida pela ocupação de ${quads} quadrantes.</p>
                </div>
            `;
            document.getElementById('container-cartas-geradas').appendChild(card);
        }

        function ativarSugestaoHistorica() {
            limparSistema();
            document.getElementById('painel-analytics').classList.remove('hidden');
            const lista = document.getElementById('lista-detalhada-estatisticas');
            bancoDeDadosElite.forEach(item => {
                const b = document.getElementById(`btn-sel-${item.numero}`);
                dezenasSelecionadas.add(item.numero); b.classList.add('numero-selecionado');
                const perc = ((item.frequencia / TOTAL_CONCURSOS) * 100).toFixed(2);
                lista.innerHTML += `<div class="bloco-estatistico"><div class="flex justify-between font-bold text-xs uppercase mb-1"><span>Dezena ${item.numero}</span><span class="text-green-500">${perc}%</span></div><div class="barra-frequencia-container"><div class="barra-frequencia-progresso" style="width:${perc}%"></div></div><p class="text-[10px] text-slate-500 mt-2 italic">${item.racional}</p></div>`;
            });
        }

        function limparSistema() {
            dezenasSelecionadas.clear();
            document.querySelectorAll('#volante-principal button').forEach(b => b.classList.remove('numero-selecionado'));
            document.getElementById('container-cartas-geradas').innerHTML = '<div class="col-span-full py-32 text-center border-2 border-dashed border-slate-800 rounded-[3rem] opacity-30 italic">Pronto para nova forja.</div>';
            document.getElementById('painel-analytics').classList.add('hidden');
            document.getElementById('lista-detalhada-estatisticas').innerHTML = '';
        }
        inicializarVolanteSelecao();
    </script>
</body>
</html>
